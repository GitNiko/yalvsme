谷歌分析
=======================
SPA(single page web application)在网站流量分析上远不如静态页面那么方便，直接在Html标签上加上统计的代码(百度统计，CNZZ，GA之类的)就可以统计到用户各个页面的访问量，停留时间等等。然后SPA通常使用的是HashRouter(/#/somerouter)的这种方式，这样统计代码就无法统计到页面其他的前端路由的访问了。

## 传统的网站的统计方式
浏览器通过地址(https://xxx.xx/login)访问内容，然后再访问另一个内容的时候不会停留在当前页面，而是会再请求新的页面(https://xxx.xx/home)。这样统计代码只需要插入到每个返回的页面里面就可以了。每次页面被浏览器加载后，统计代码都会执行一下，然后发送当前页面的一些信息给统计服务器(例如 title, path, 访问时间等等)。这样就足够统计分析用户的基本行为了。

## SPA的统计方式
浏览器一次加载好前端的所有资源，通过前端路由的方式(https://xxx.xx/#/login)区分各个页面, `#`后面的内容是不会发送给服务器的。后续的页面切换都只是在一个文档流(document)中完成的,不会再从服务器获取文档。所以统计代码只会加载一次，那么只会又一次统计请求的发送，只会发送第一次访问的时的信息(title,path都是固定的),而事实上用户在多个页面上跳转了,但是却无法统计到这些行为。

当然，这也是有相对应的解决方法。一般统计代码都会暴露出对应的接口，让开发者能够主动发送统计请求。所以，一般会在通过`HashChangeEvent`的方式添加一个监听函数，只要是路由有变化就调用一下统计接口。

## GTM(Google Tag Manager)
上面的解决方案并不合理，显式的调用统计接口的逻辑明显会`污染`我们的代码，当统计内容，统计接口改的时候我们还需要更新我们的代码。如果代码重构，还需要考虑到这方面的逻辑。  

幸运的是我们能够用`Google Tag Manager(跟踪代码管理器)`了!  

基于`Google Analytics`,`GTM`可以有效的管理我们用于统计的代码了, 最大的好处就是我们的统计代码是实时的被加载的。我们在`GTM`上配置好统计代码,点击发布后 嵌入页面的统计代码也会`更新`成最新的。我们可以放心的把调用统计接口的逻辑从我们的项目中剔除出去了。

## 机制


## GTM使用


## references
[Tag management system](https://en.wikipedia.org/wiki/Tag_management_system)